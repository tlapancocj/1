<!DOCTYPE html>
<html>
  <head>
    <title>Registro de Autos MUESTRA</title>
    <!-- Incluir el SDK de Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-auth.js"></script>
  </head>
  <body>
    <!-- Formulario para el registro de autos -->
    <h1>Registro de Autos</h1>
    <button id="registroAutoBtn">Registrar Auto</button>
    
    <!-- Script de Firebase y lógica de aplicación -->
    <script>
      // Configuración de Firebase
      const firebaseConfig = {
           apiKey: "AIzaSyC1YGqAlWirgjr3KSVV0LU358riVwmX6q8",
    authDomain: "registroautos-maria.firebaseapp.com",
    projectId: "registroautos-maria",
    storageBucket: "registroautos-maria.appspot.com",
    messagingSenderId: "1032038307825",
    appId: "1:1032038307825:web:4d1a0f1e225c28c7965650",
    measurementId: "G-K8XPFF93HY"
      };

      // Inicializar Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      // Referencia a la colección de autos
      const autosRef = db.collection('autos');

      // Función para registrar auto con número de ingreso automático
      function registrarAutoConNumero() {
        // Obtener la cantidad actual de autos registrados
        autosRef.get().then((querySnapshot) => {
          const numeroIngreso = querySnapshot.size + 1; // Calcula el siguiente número de ingreso

          // Crear el objeto del auto con el número de ingreso y la hora de entrada del servidor
          const nuevoAuto = {
            numeroIngreso: numeroIngreso,
            horaEntrada: firebase.firestore.FieldValue.serverTimestamp(),
          };

          // Registrar el auto en Firestore
          autosRef.add(nuevoAuto).then(() => {
            console.log("Auto registrado exitosamente con número de ingreso:", numeroIngreso);
            alert("Auto registrado exitosamente con número de ingreso: " + numeroIngreso);
          }).catch((error) => {
            console.error("Error al registrar el auto: ", error);
          });

        }).catch((error) => {
          console.error("Error al obtener la cantidad de autos registrados: ", error);
        });
      }

      // Evento de clic para el botón de registro de autos
      document.getElementById('registroAutoBtn').addEventListener('click', registrarAutoConNumero);

    </script>
  </body>
</html>
